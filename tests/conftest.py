import pandas as pd
import pytest

from scripts.splitter import Sentence_processing


@pytest.fixture()
def data():
    data = {
        "FILE_ID": [
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
        ],
        "CommentType": [1, 3, 2, 1, 3, 1, 2, 3, 3, 3, 3, 1, 2, 2, 1, 1, 1, 1, 1, 2],
        "deident_3": [
            "John ate an apple for lunch. It was noce. But not chocolate.",
            "Successfully installed accelerate-0 psutil-5 safetensors-0 tokenizers-0 transformers-4",
            "Teh cat sat on the hat.",
            "desk sofa apple list chickn dog",
            "chair, table, coffee, -1",
            "Frodo Baggins was extremely helpful explaining my daughters treatment to her",
            "Always takes you through what is happening to your teeth. Very informative and amazing at the job. Highly recommend Greg to anyone",
            "Pleasant welcome, precise care & treatment. Considerate, you are listened to, patient & understanding",
            "All the staff and everyone is so  kind and helpful. Lovely. The dentists Tom Mason and Dominic Jerry are two of the best dentists I have ever seen",
            "the lawyers were mean!!.,",
            "One thing my food came late.",
            "My food wasnt nice, it was on top of the TV",
            "I didn't like porridge&nbsp;",
            "CatAlina DOING EEG WAS AMAZING",
            "Friendly service, staff always smiling and advising on waiting times etc.&nbsp; Liked the concept of the transition cards also enjoyed the flute player ðŸ˜€<div>Things to do : Potentially a small Tuc Shop / vending machine with any profits going back in to the GOSH funds.</div>",
            "Staff were really polite! :)<div>Already pretty good :)</div>Thank you!",
            "Staff, as always, are brilliant<div>We got lost so many times&nbsp;</div><div>:D</div>",
            "cheese & carrots were a wierd meal",
            "<p>Very friendly &amp; Knowledgeable staff.</p><p><br></p><p>Clean Facilities</p><p><br></p><p>Swift servicing with minimal waiting.</p><p><br></p><p>(Hopefully the treatments received work! )</p><p><br></p>",
            "Always takes you through what is happening to your teeth.Very informative and amazing at the job:Highly recommend Greg to anyone",
        ],
    }
    return data


@pytest.fixture()
def sentence_split_df(data):
    # based on comments from https://www.martinslanedental.com/fft-comments/
    df = pd.DataFrame(data)
    split_sentence = list(Sentence_processing.get_sentence_split_v1(df))
    return split_sentence


@pytest.fixture()
def prediction_output():
    prediction_output = {
        "sentence_order": {
            0: 0,
            1: 1,
            2: 2,
            3: 3,
            4: 4,
            5: 5,
            6: 6,
            7: 7,
            8: 8,
            9: 9,
            10: 10,
            11: 11,
            12: 12,
            13: 13,
            14: 14,
            15: 15,
            16: 16,
            17: 17,
            18: 18,
            19: 19,
            20: 20,
            21: 21,
            22: 22,
            23: 23,
            24: 24,
            25: 25,
            26: 26,
            27: 27,
            28: 28,
            29: 29,
            30: 30,
            31: 31,
            32: 32,
        },
        "original_index": {
            0: 0,
            1: 0,
            2: 0,
            3: 1,
            4: 2,
            5: 3,
            6: 4,
            7: 5,
            8: 6,
            9: 6,
            10: 6,
            11: 7,
            12: 7,
            13: 8,
            14: 8,
            15: 8,
            16: 9,
            17: 10,
            18: 11,
            19: 12,
            20: 13,
            21: 14,
            22: 14,
            23: 15,
            24: 15,
            25: 16,
            26: 16,
            27: 17,
            28: 18,
            29: 18,
            30: 18,
            31: 19,
            32: 19,
        },
        "FILE_ID": {
            0: 1,
            1: 1,
            2: 1,
            3: 2,
            4: 3,
            5: 4,
            6: 5,
            7: 6,
            8: 7,
            9: 7,
            10: 7,
            11: 8,
            12: 8,
            13: 9,
            14: 9,
            15: 9,
            16: 10,
            17: 11,
            18: 12,
            19: 13,
            20: 14,
            21: 15,
            22: 15,
            23: 16,
            24: 16,
            25: 17,
            26: 17,
            27: 18,
            28: 19,
            29: 19,
            30: 19,
            31: 20,
            32: 20,
        },
        "CommentType": {
            0: 1,
            1: 1,
            2: 1,
            3: 3,
            4: 2,
            5: 1,
            6: 3,
            7: 1,
            8: 2,
            9: 2,
            10: 2,
            11: 3,
            12: 3,
            13: 3,
            14: 3,
            15: 3,
            16: 3,
            17: 3,
            18: 1,
            19: 2,
            20: 2,
            21: 1,
            22: 1,
            23: 1,
            24: 1,
            25: 1,
            26: 1,
            27: 1,
            28: 1,
            29: 1,
            30: 1,
            31: 2,
            32: 2,
        },
        "Sentence": {
            0: "[name] ate an apple for lunch.",
            1: "it was noce.",
            2: "but not chocolate.",
            3: "successfully installed accelerate- psutil- safetensors- tokenizers- transformers-",
            4: "teh cat sat on the hat.",
            5: "desk sofa apple list chickn dog",
            6: "chair, table, coffee, -",
            7: "[name] was extremely helpful explaining my daughters treatment to her",
            8: "always takes you through what is happening to your teeth.",
            9: "very informative and amazing at the job.",
            10: "highly recommend [name] to anyone",
            11: "pleasant welcome, precise care & treatment.",
            12: "considerate, you are listened to, patient & understanding",
            13: "all the staff and everyone is so kind and helpful.",
            14: "lovely.",
            15: "the dentists [name] and [name] are two of the best dentists i have ever seen",
            16: "the lawyers were mean!",
            17: "one thing my food came late.",
            18: "my food wasnt nice, it was on top of the tv",
            19: "i didn't like porridge",
            20: "xxx doing eeg was amazing",
            21: "friendly service, staff always smiling and advising on waiting times etc.",
            22: "liked the concept of the transition cards also enjoyed the flute player [name] to do : potentially a small tuc shop / vending machine with any profits going back in to the gosh funds.",
            23: "staff were really polite!",
            24: ":) already pretty good :)",
            25: "staff, as always, are brilliant.",
            26: "we got lost so many times : d",
            27: "cheese & carrots were a wierd meal",
            28: "very friendly & knowledgeable staff.",
            29: "clean facilities swift servicing with minimal waiting.",
            30: "(hopefully the treatments received work! )",
            31: "always takes you through what is happening to your teeth.",
            32: "very informative and amazing at the job: highly recommend [name] to anyone",
        },
        "sentiment": {
            0: -1,
            1: 0,
            2: -1,
            3: 1,
            4: -1,
            5: -1,
            6: -1,
            7: 1,
            8: 1,
            9: 1,
            10: -1,
            11: 1,
            12: 1,
            13: 1,
            14: 1,
            15: 1,
            16: 1,
            17: -1,
            18: -1,
            19: 0,
            20: 1,
            21: 1,
            22: -1,
            23: 1,
            24: 1,
            25: 1,
            26: 1,
            27: -1,
            28: 1,
            29: 1,
            30: 1,
            31: 1,
            32: 1,
        },
        "topic": {
            0: 4,
            1: 9,
            2: 0,
            3: 0,
            4: 9,
            5: 4,
            6: 4,
            7: 3,
            8: 2,
            9: 3,
            10: 0,
            11: 1,
            12: 1,
            13: 1,
            14: 9,
            15: 9,
            16: 1,
            17: 4,
            18: 4,
            19: 0,
            20: 9,
            21: 8,
            22: 4,
            23: 1,
            24: 9,
            25: 9,
            26: 9,
            27: 4,
            28: 3,
            29: 4,
            30: 1,
            31: 2,
            32: 3,
        },
        "Theme_consensus": {
            0: 0.8072472214698792,
            1: 0.5830379128456116,
            2: 0.9923999309539795,
            3: 0.9653044939041138,
            4: 0.9536478519439697,
            5: 0.9005905985832214,
            6: 0.62586510181427,
            7: 0.7820577621459961,
            8: 0.8359195590019226,
            9: 0.7903935313224792,
            10: 0.9894248247146606,
            11: 0.8405317068099976,
            12: 0.8725425004959106,
            13: 0.8514313101768494,
            14: 0.6504683494567871,
            15: 0.8018786311149597,
            16: 0.9462754726409912,
            17: 0.46850675344467163,
            18: 0.8968979120254517,
            19: 0.9693922996520996,
            20: 0.8222753405570984,
            21: 0.4586818218231201,
            22: 0.5821704268455505,
            23: 0.5238872766494751,
            24: 0.6813148856163025,
            25: 0.3794499933719635,
            26: 0.6949632167816162,
            27: 0.7962659597396851,
            28: 0.5145539045333862,
            29: 0.505740225315094,
            30: 0.9279011487960815,
            31: 0.8359195590019226,
            32: 0.8230841755867004,
        },
        "Sentiment_consensus": {
            0: 0.9961198568344116,
            1: 0.8783215284347534,
            2: 0.9910582304000854,
            3: 0.9157070517539978,
            4: 0.957972526550293,
            5: 0.9868261218070984,
            6: 0.5440491437911987,
            7: 0.9215503334999084,
            8: 0.8812428712844849,
            9: 0.8857119679450989,
            10: 0.9953615069389343,
            11: 0.8405317068099976,
            12: 0.8725425004959106,
            13: 0.8514313101768494,
            14: 0.8381907343864441,
            15: 0.7823053598403931,
            16: 0.9462754726409912,
            17: 0.8803973197937012,
            18: 0.9205726981163025,
            19: 0.9693922996520996,
            20: 0.9282458424568176,
            21: 0.7527365684509277,
            22: 0.913478672504425,
            23: 0.5238872766494751,
            24: 0.8307808637619019,
            25: 0.8672999739646912,
            26: 0.916391134262085,
            27: 0.968776524066925,
            28: 0.7246528267860413,
            29: 0.7393777370452881,
            30: 0.9279011487960815,
            31: 0.8812428712844849,
            32: 0.8711709380149841,
        },
    }
    prediction_output = pd.DataFrame(prediction_output)
    return prediction_output
